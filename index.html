<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no,viewport-fit=cover">
<meta name="theme-color" content="#ff7a00">
<meta name="description" content="Ses komutları, yapay zeka destekli kategorizasyon ve modern arayüz ile kişisel not alma uygulaması">
<meta name="keywords" content="not, notlar, ses komutları, yapay zeka, PWA, mobil uygulama">
<meta name="author" content="Kendime">

<!-- PWA Meta Tags -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="Kendime">
<meta name="mobile-web-app-capable" content="yes">
<meta name="msapplication-TileColor" content="#ff7a00">
<meta name="msapplication-navbutton-color" content="#ff7a00">
<meta name="application-name" content="Kendime">

<!-- Icons -->
<link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' rx='20' fill='%23ff7a00'/><text x='50' y='65' font-size='60' text-anchor='middle' fill='white' font-family='system-ui' font-weight='bold'>K</text></svg>">
<link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 180 180'><rect width='180' height='180' rx='40' fill='%23ff7a00'/><text x='90' y='125' font-size='120' text-anchor='middle' fill='white' font-family='system-ui' font-weight='bold'>K</text></svg>">

<!-- Manifest -->
<link rel="manifest" href="manifest.json">

<title>Kendime — Kişisel Not Uygulaması</title>
<style>
  :root{
    --accent:#ff7a00;
    --accent-light:#ff8a1f;
    --accent-dark:#e66900;
    --bg:#f8f9fa;
    --fg:#212529;
    --card:#ffffff;
    --muted:#6c757d;
    --border:#dee2e6;
    --success:#28a745;
    --warning:#ffc107;
    --danger:#dc3545;
    --info:#17a2b8;
    --shadow:0 0.125rem 0.25rem rgba(0,0,0,0.075);
    --shadow-lg:0 1rem 3rem rgba(0,0,0,0.175);
    --gradient:linear-gradient(135deg, var(--accent) 0%, var(--accent-light) 100%);
  }

  [data-theme="dark"] {
    --bg:#1a1d29;
    --fg:#e9ecef;
    --card:#2d3748;
    --muted:#a0aec0;
    --border:#4a5568;
    --shadow:0 0.125rem 0.25rem rgba(0,0,0,0.3);
  }

  * {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }

  body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    background: var(--bg);
    color: var(--fg);
    line-height: 1.6;
    font-size: 16px;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    overflow-x: hidden;
  }

  header {
    position: sticky;
    top: 0;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(20px) saturate(180%);
    border-bottom: 1px solid var(--border);
    padding: 12px 20px;
    display: flex;
    align-items: center;
    z-index: 1000;
    transition: all 0.3s ease;
  }

  [data-theme="dark"] header {
    background: rgba(45, 55, 72, 0.95);
  }

  .header-left {
    display: flex;
    align-items: center;
    min-width: 60px;
  }

  .header-center {
    flex: 1;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .header-right {
    display: flex;
    align-items: center;
    gap: 12px;
    min-width: 60px;
    justify-content: flex-end;
  }

  .logo {
    width: 40px;
    height: 40px;
    border-radius: 12px;
    background: var(--gradient);
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    font-size: 18px;
    box-shadow: var(--shadow);
    transition: transform 0.2s ease;
  }

  .logo:hover {
    transform: scale(1.05);
  }

  .title {
    font-weight: 700;
    font-size: 24px;
    color: var(--accent);
    text-decoration: none;
    transition: all 0.3s ease;
  }

  .title:hover {
    color: var(--accent-light);
  }

  .search-container {
    max-width: 500px;
    width: 100%;
    position: relative;
    background: var(--card);
    border: 2px solid var(--border);
    border-radius: 25px;
    padding: 8px 16px;
    display: flex;
    align-items: center;
    gap: 8px;
    box-shadow: var(--shadow);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .search-container:focus-within {
    border-color: var(--accent);
    box-shadow: 0 0 0 4px rgba(255, 122, 0, 0.1);
    transform: translateY(-1px);
  }

  .search-icon {
    color: var(--muted);
    font-size: 16px;
  }

  .search input {
    flex: 1;
    border: none;
    outline: none;
    background: transparent;
    font-size: 16px;
    color: var(--fg);
    font-weight: 500;
  }

  .search input::placeholder {
    color: var(--muted);
  }

  .action-btn {
    background: none;
    border: none;
    cursor: pointer;
    padding: 8px;
    border-radius: 50%;
    transition: all 0.2s ease;
    color: var(--muted);
    font-size: 16px;
    width: 36px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .action-btn:hover {
    background: rgba(255, 122, 0, 0.1);
    color: var(--accent);
    transform: scale(1.1);
  }

  .action-btn.listening {
    background: var(--danger);
    color: white;
    animation: pulse 2s infinite;
  }

  @keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); }
  }

  .container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 20px;
  }

  .quick-actions {
    background: var(--card);
    border-radius: 16px;
    padding: 16px;
    margin-bottom: 20px;
    box-shadow: var(--shadow);
    border: 1px solid var(--border);
  }

  .quick-actions .button-group {
    display: flex;
    gap: 12px;
    justify-content: center;
    flex-wrap: wrap;
  }

  .btn {
    padding: 12px 20px;
    border: none;
    border-radius: 12px;
    font-weight: 600;
    font-size: 14px;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    display: flex;
    align-items: center;
    gap: 8px;
    text-decoration: none;
    min-height: 44px;
    position: relative;
    overflow: hidden;
  }

  .btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
    transition: left 0.5s;
  }

  .btn:hover::before {
    left: 100%;
  }

  .btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0,0,0,0.15);
  }

  .btn:active {
    transform: translateY(0);
  }

  .btn-primary {
    background: var(--gradient);
    color: white;
    box-shadow: 0 4px 15px rgba(255, 122, 0, 0.3);
  }

  .btn-secondary {
    background: var(--card);
    color: var(--fg);
    border: 2px solid var(--border);
  }

  .btn-success {
    background: linear-gradient(135deg, var(--success), #34ce57);
    color: white;
    box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
  }

  .btn-danger {
    background: linear-gradient(135deg, var(--danger), #e55370);
    color: white;
    box-shadow: 0 4px 15px rgba(220, 53, 69, 0.3);
  }

  .note-form {
    background: var(--card);
    border-radius: 20px;
    padding: 24px;
    margin-bottom: 24px;
    box-shadow: var(--shadow-lg);
    border: 1px solid var(--border);
    transition: all 0.3s ease;
  }

  .note-form:hover {
    transform: translateY(-2px);
    box-shadow: 0 1.5rem 4rem rgba(0,0,0,0.1);
  }

  .form-row {
    display: grid;
    grid-template-columns: 1fr 1fr auto;
    gap: 16px;
    margin-bottom: 16px;
  }

  .form-group {
    position: relative;
  }

  .form-control {
    width: 100%;
    padding: 14px 16px;
    border: 2px solid var(--border);
    border-radius: 12px;
    font-size: 16px;
    font-weight: 500;
    background: var(--card);
    color: var(--fg);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .form-control:focus {
    outline: none;
    border-color: var(--accent);
    box-shadow: 0 0 0 4px rgba(255, 122, 0, 0.1);
    transform: translateY(-1px);
  }

  .form-control::placeholder {
    color: var(--muted);
    font-weight: 400;
  }

  textarea.form-control {
    resize: vertical;
    min-height: 120px;
    font-family: inherit;
  }

  .color-picker {
    display: flex;
    gap: 8px;
    margin: 16px 0;
    padding: 8px 0;
  }

  .color-dot {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    cursor: pointer;
    border: 3px solid transparent;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
  }

  .color-dot:hover {
    transform: scale(1.2);
    border-color: var(--fg);
  }

  .color-dot.active {
    border-color: var(--accent);
    transform: scale(1.3);
    box-shadow: 0 0 0 2px var(--accent);
  }

  .notes-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    gap: 20px;
    margin-top: 24px;
  }

  .note-card {
    background: var(--card);
    border-radius: 16px;
    padding: 20px;
    border: 1px solid var(--border);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
  }

  .note-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: var(--gradient);
    transform: scaleX(0);
    transition: transform 0.3s ease;
  }

  .note-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 20px 40px rgba(0,0,0,0.1);
  }

  .note-card:hover::before {
    transform: scaleX(1);
  }

  .note-card.pinned {
    border-left: 4px solid var(--accent);
  }

  .note-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 12px;
  }

  .note-title {
    font-weight: 700;
    font-size: 18px;
    color: var(--fg);
    margin-bottom: 8px;
    line-height: 1.3;
  }

  .note-content {
    color: var(--muted);
    line-height: 1.6;
    margin-bottom: 16px;
    white-space: pre-wrap;
    word-break: break-word;
  }

  .note-meta {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 12px;
    color: var(--muted);
    margin-top: 16px;
    padding-top: 16px;
    border-top: 1px solid var(--border);
  }

  .note-actions {
    display: flex;
    gap: 8px;
    opacity: 0;
    transition: opacity 0.3s ease;
  }

  .note-card:hover .note-actions {
    opacity: 1;
  }

  .note-action {
    width: 32px;
    height: 32px;
    border: none;
    border-radius: 8px;
    background: var(--bg);
    color: var(--muted);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
    font-size: 14px;
  }

  .note-action:hover {
    background: var(--accent);
    color: white;
    transform: scale(1.1);
  }

  .tag {
    display: inline-block;
    background: rgba(255, 122, 0, 0.1);
    color: var(--accent);
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 600;
    margin: 4px 4px 4px 0;
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .tag:hover {
    background: var(--accent);
    color: white;
  }

  .category-badge {
    background: var(--gradient);
    color: white;
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 600;
    display: inline-flex;
    align-items: center;
    gap: 4px;
  }

  .floating-btn {
    position: fixed;
    bottom: 24px;
    right: 24px;
    width: 64px;
    height: 64px;
    border-radius: 50%;
    background: var(--gradient);
    color: white;
    border: none;
    font-size: 24px;
    cursor: pointer;
    box-shadow: 0 8px 32px rgba(255, 122, 0, 0.4);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    z-index: 999;
  }

  .floating-btn:hover {
    transform: scale(1.1) rotate(90deg);
    box-shadow: 0 12px 40px rgba(255, 122, 0, 0.6);
  }

  .modal {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.6);
    backdrop-filter: blur(8px);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 2000;
    padding: 20px;
  }

  .modal.show {
    display: flex;
  }

  .modal-content {
    background: var(--card);
    border-radius: 20px;
    padding: 32px;
    max-width: 600px;
    width: 100%;
    max-height: 90vh;
    overflow-y: auto;
    box-shadow: var(--shadow-lg);
    border: 1px solid var(--border);
    transform: scale(0.9);
    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .modal.show .modal-content {
    transform: scale(1);
  }

  .modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 24px;
    padding-bottom: 16px;
    border-bottom: 2px solid var(--border);
  }

  .modal-title {
    font-size: 24px;
    font-weight: 700;
    color: var(--fg);
  }

  .close-btn {
    width: 40px;
    height: 40px;
    border: none;
    border-radius: 50%;
    background: var(--bg);
    color: var(--muted);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
  }

  .close-btn:hover {
    background: var(--danger);
    color: white;
  }

  .toast {
    position: fixed;
    top: 24px;
    right: 24px;
    padding: 16px 24px;
    border-radius: 12px;
    color: white;
    font-weight: 600;
    z-index: 3000;
    transform: translateX(400px);
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow: var(--shadow-lg);
    max-width: 400px;
  }

  .toast.show {
    transform: translateX(0);
  }

  .toast.success {
    background: linear-gradient(135deg, var(--success), #34ce57);
  }

  .toast.warning {
    background: linear-gradient(135deg, var(--warning), #ffcd39);
    color: #333;
  }

  .toast.danger {
    background: linear-gradient(135deg, var(--danger), #e55370);
  }

  .stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 16px;
    margin-bottom: 24px;
  }

  .stat-card {
    background: var(--card);
    border-radius: 16px;
    padding: 20px;
    text-align: center;
    border: 1px solid var(--border);
    transition: all 0.3s ease;
  }

  .stat-card:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-lg);
  }

  .stat-number {
    font-size: 32px;
    font-weight: 700;
    color: var(--accent);
    margin-bottom: 8px;
  }

  .stat-label {
    color: var(--muted);
    font-weight: 600;
  }

  .theme-toggle {
    background: var(--card);
    border: 2px solid var(--border);
    border-radius: 25px;
    padding: 4px;
    display: flex;
    align-items: center;
    cursor: pointer;
    transition: all 0.3s ease;
    width: 60px;
    height: 32px;
    position: relative;
  }

  .theme-toggle::before {
    content: '🌞';
    position: absolute;
    left: 4px;
    top: 50%;
    transform: translateY(-50%);
    transition: all 0.3s ease;
    font-size: 16px;
  }

  [data-theme="dark"] .theme-toggle::before {
    content: '🌙';
    left: calc(100% - 24px);
  }

  .loading {
    display: inline-block;
    width: 20px;
    height: 20px;
    border: 3px solid var(--border);
    border-radius: 50%;
    border-top-color: var(--accent);
    animation: spin 1s ease-in-out infinite;
  }

  @keyframes spin {
    to { transform: rotate(360deg); }
  }

  .count-badge {
    background: var(--accent);
    color: white;
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 12px;
    font-weight: 700;
    min-width: 20px;
    text-align: center;
  }

  /* Mobile Optimizations */
  @media (max-width: 768px) {
    .container {
      padding: 12px;
    }

    .header-center {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
    }

    .search-container {
      max-width: 280px;
    }

    .form-row {
      grid-template-columns: 1fr;
      gap: 12px;
    }

    .quick-actions .button-group {
      flex-direction: column;
    }

    .notes-grid {
      grid-template-columns: 1fr;
      gap: 16px;
    }

    .floating-btn {
      bottom: 16px;
      right: 16px;
      width: 56px;
      height: 56px;
      font-size: 20px;
    }

    .modal-content {
      padding: 24px;
      margin: 12px;
    }

    .toast {
      right: 12px;
      left: 12px;
      transform: translateY(-100px);
    }

    .toast.show {
      transform: translateY(0);
    }
  }

  /* Touch Optimizations */
  @media (hover: none) and (pointer: coarse) {
    .btn {
      min-height: 48px;
    }

    .form-control {
      min-height: 48px;
    }

    .action-btn {
      width: 44px;
      height: 44px;
    }

    .note-action {
      width: 44px;
      height: 44px;
    }
  }

  /* Dark theme enhancements */
  [data-theme="dark"] .note-card {
    box-shadow: 0 4px 20px rgba(0,0,0,0.3);
  }

  [data-theme="dark"] .btn-secondary {
    background: var(--card);
    border-color: var(--border);
  }

  /* High contrast mode */
  @media (prefers-contrast: high) {
    :root {
      --border: #000;
      --shadow: 0 2px 4px rgba(0,0,0,0.5);
    }

    .btn {
      border: 2px solid currentColor;
    }
  }

  /* Reduced motion */
  @media (prefers-reduced-motion: reduce) {
    * {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
    }
  }

  /* Scrollbar styling */
  ::-webkit-scrollbar {
    width: 8px;
  }

  ::-webkit-scrollbar-track {
    background: var(--bg);
  }

  ::-webkit-scrollbar-thumb {
    background: var(--muted);
    border-radius: 4px;
  }

  ::-webkit-scrollbar-thumb:hover {
    background: var(--accent);
  }
</style>
</head>
<body>
<header>
  <div class="header-left">
    <div class="logo">K</div>
  </div>

  <div class="header-center">
    <a href="/" class="title">Kendime</a>
  </div>

  <div class="header-right">
    <form class="search-container" onsubmit="event.preventDefault(); doSearch()">
      <span class="search-icon">🔍</span>
      <input id="searchInput" type="text" placeholder="Notlarda ara..." oninput="doSearch()">
      <button type="button" class="action-btn" onclick="toggleVoiceSearch()" title="Sesli arama">
        🎤
      </button>
      <button type="button" class="action-btn" onclick="openPhotoUpload()" title="Fotoğraf yükle">
        📷
      </button>
      <input type="file" id="photoUpload" accept="image/*" style="display:none" onchange="handlePhotoUpload(event)">
    </form>

    <button class="theme-toggle" onclick="toggleTheme()" title="Tema değiştir"></button>
    <button class="action-btn" onclick="showSettings()" title="Ayarlar">⚙️</button>
  </div>
</header>

<div class="container">
  <!-- Quick Actions -->
  <div class="quick-actions">
    <div class="button-group">
      <button class="btn btn-primary" onclick="addNote()" title="Not ekle (Ctrl+Enter)">
        📝 Not Ekle
      </button>
      <button class="btn btn-secondary" onclick="clearForm()" title="Temizle (Esc)">
        🗑️ Temizle
      </button>
      <button class="btn btn-success" onclick="startVoiceNote()" title="Sesli not (Ctrl+Shift+N)">
        🎤 Sesli Not
      </button>
    </div>
  </div>

  <!-- Note Form -->
  <div class="note-form">
    <div class="form-row">
      <div class="form-group">
        <input id="titleInput" class="form-control" type="text" placeholder="Başlık (Ctrl+N ile hızlı ekleme)">
      </div>
      <div class="form-group">
        <input id="tagsInput" class="form-control" type="text" placeholder="Etiketler (virgülle ayır)">
      </div>
      <div class="form-group">
        <select id="categorySelect" class="form-control">
          <option value="">Kategori seçin</option>
          <option value="Kişisel">📝 Kişisel</option>
          <option value="İş">💼 İş</option>
          <option value="Fikir">💡 Fikir</option>
          <option value="Görev">✅ Görev</option>
          <option value="Önemli">⭐ Önemli</option>
        </select>
      </div>
    </div>

    <div class="form-group">
      <textarea id="contentInput" class="form-control" placeholder="Not içeriği... (Ses komutları: 'not ekle', 'temizle', 'ara')"></textarea>
    </div>

    <div class="color-picker">
      <div class="color-dot" style="background:#ffffff" data-color="#ffffff" onclick="selectColor('#ffffff')"></div>
      <div class="color-dot" style="background:#fff3cd" data-color="#fff3cd" onclick="selectColor('#fff3cd')"></div>
      <div class="color-dot" style="background:#f8d7da" data-color="#f8d7da" onclick="selectColor('#f8d7da')"></div>
      <div class="color-dot" style="background:#d1ecf1" data-color="#d1ecf1" onclick="selectColor('#d1ecf1')"></div>
      <div class="color-dot" style="background:#d4edda" data-color="#d4edda" onclick="selectColor('#d4edda')"></div>
      <div class="color-dot" style="background:#e2e3f1" data-color="#e2e3f1" onclick="selectColor('#e2e3f1')"></div>
    </div>

    <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 16px;">
      <span id="noteCount" class="count-badge">0 not</span>
    </div>
  </div>

  <!-- Notes Grid -->
  <div id="notesContainer" class="notes-grid"></div>
</div>

<!-- Floating Action Button -->
<button class="floating-btn" onclick="quickAdd()" title="Hızlı not (Ctrl+N)">+</button>

<!-- Modals -->
<div id="editModal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3 class="modal-title">✏️ Notu Düzenle</h3>
      <button class="close-btn" onclick="closeModal('editModal')">✕</button>
    </div>
    <div class="form-group">
      <input id="editTitle" class="form-control" type="text" placeholder="Başlık">
    </div>
    <div class="form-group">
      <textarea id="editContent" class="form-control" placeholder="İçerik" rows="6"></textarea>
    </div>
    <div class="form-group">
      <input id="editTags" class="form-control" type="text" placeholder="Etiketler">
    </div>
    <div class="form-group">
      <select id="editCategory" class="form-control">
        <option value="">Kategori seçin</option>
        <option value="Kişisel">📝 Kişisel</option>
        <option value="İş">💼 İş</option>
        <option value="Fikir">💡 Fikir</option>
        <option value="Görev">✅ Görev</option>
        <option value="Önemli">⭐ Önemli</option>
      </select>
    </div>
    <div style="display: flex; gap: 12px; margin-top: 24px;">
      <button class="btn btn-success" onclick="saveEdit()">💾 Kaydet</button>
      <button class="btn btn-secondary" onclick="closeModal('editModal')">❌ İptal</button>
    </div>
  </div>
</div>

<div id="statsModal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3 class="modal-title">📊 İstatistikler</h3>
      <button class="close-btn" onclick="closeModal('statsModal')">✕</button>
    </div>
    <div id="statsContent"></div>
  </div>
</div>

<div id="settingsModal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3 class="modal-title">⚙️ Ayarlar</h3>
      <button class="close-btn" onclick="closeModal('settingsModal')">✕</button>
    </div>
    <div id="settingsContent">
      <div style="margin-bottom: 20px;">
        <h4 style="margin-bottom: 12px;">🎨 Görünüm</h4>
        <button class="btn btn-secondary" onclick="toggleTheme()">🌓 Tema Değiştir</button>
      </div>
      <div style="margin-bottom: 20px;">
        <h4 style="margin-bottom: 12px;">📊 Veri</h4>
        <div style="display: flex; gap: 12px; flex-wrap: wrap;">
          <button class="btn btn-success" onclick="exportNotes()">💾 Dışa Aktar</button>
          <button class="btn btn-secondary" onclick="document.getElementById('importFile').click()">📂 İçe Aktar</button>
          <button class="btn btn-danger" onclick="clearAllData()">🗑️ Tümünü Sil</button>
        </div>
      </div>
      <div>
        <button class="btn btn-secondary" onclick="showStats()">📊 İstatistikleri Göster</button>
      </div>
    </div>
  </div>
</div>

<input type="file" id="importFile" accept=".json" onchange="importNotes()" style="display:none">

<script>
// Modern JavaScript with ES6+ features
class KendimeApp {
  constructor() {
    this.STORAGE_KEY = 'kendime_notes_v3';
    this.notes = this.loadNotes();
    this.query = '';
    this.selectedColor = '#ffffff';
    this.editingId = null;
    this.recognition = null;
    this.isListening = false;
    this.isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);

    this.init();
  }

  init() {
    this.setupSpeechRecognition();
    this.setupEventListeners();
    this.setupPWA();
    this.render();
    this.updateColorPicker();
    this.showWelcomeMessage();
  }

  setupServiceWorker() {
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/sw.js')
        .then(registration => {
          console.log('Service Worker registered:', registration);

          registration.addEventListener('updatefound', () => {
            const newWorker = registration.installing;
            newWorker.addEventListener('statechange', () => {
              if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                this.showToast('Yeni güncelleme mevcut! Sayfayı yenileyin.', 'warning');
              }
            });
          });
        })
        .catch(error => console.log('Service Worker registration failed:', error));
    }
  }

  setupSpeechRecognition() {
    if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
      this.recognition = new SpeechRecognition();
      this.recognition.continuous = false;
      this.recognition.interimResults = false;
      this.recognition.lang = 'tr-TR';

      this.recognition.onresult = (event) => {
        const transcript = event.results[0][0].transcript.toLowerCase();
        this.handleVoiceCommand(transcript);
      };

      this.recognition.onerror = (event) => {
        this.showToast(`Ses tanıma hatası: ${event.error}`, 'danger');
        this.stopListening();
      };

      this.recognition.onend = () => {
        this.stopListening();
      };
    }
  }

  setupEventListeners() {
    // Keyboard shortcuts
    document.addEventListener('keydown', (e) => {
      if (e.ctrlKey && e.key === 'n') {
        e.preventDefault();
        this.quickAdd();
      }
      if (e.ctrlKey && e.key === 'f') {
        e.preventDefault();
        document.getElementById('searchInput').focus();
      }
      if (e.ctrlKey && e.shiftKey && e.key === 'V') {
        e.preventDefault();
        this.toggleVoiceSearch();
      }
      if (e.ctrlKey && e.shiftKey && e.key === 'N') {
        e.preventDefault();
        this.startVoiceNote();
      }
      if (e.ctrlKey && e.key === 'Enter') {
        e.preventDefault();
        this.addNote();
      }
      if (e.key === 'Escape') {
        this.clearForm();
      }
    });

    // Close modals on outside click
    document.addEventListener('click', (e) => {
      if (e.target.classList.contains('modal')) {
        e.target.classList.remove('show');
      }
    });

    // Touch events for mobile
    if (this.isMobile) {
      this.setupTouchEvents();
    }

    // Auto-save on input
    ['titleInput', 'contentInput', 'tagsInput'].forEach(id => {
      const element = document.getElementById(id);
      if (element) {
        element.addEventListener('input', this.debounce(() => {
          this.autoSave();
        }, 1000));
      }
    });
  }

  setupTouchEvents() {
    let touchStartX = 0;
    let touchStartY = 0;

    document.addEventListener('touchstart', (e) => {
      if (e.target.closest('.note-card')) {
        touchStartX = e.touches[0].clientX;
        touchStartY = e.touches[0].clientY;
      }
    }, { passive: true });

    document.addEventListener('touchend', (e) => {
      if (!e.target.closest('.note-card')) return;

      const touchEndX = e.changedTouches[0].clientX;
      const touchEndY = e.changedTouches[0].clientY;
      const deltaX = touchStartX - touchEndX;
      const deltaY = Math.abs(touchStartY - touchEndY);

      if (Math.abs(deltaX) > 100 && deltaY < 50) {
        const noteCard = e.target.closest('.note-card');
        const noteId = this.extractNoteId(noteCard);

        if (deltaX > 0 && noteId) {
          this.hapticFeedback();
          if (confirm('Bu notu silmek istediğinizden emin misiniz?')) {
            this.removeNote(noteId);
          }
        }
      }
    }, { passive: true });
  }

  setupPWA() {
    let deferredPrompt;

    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;

      if (this.isMobile) {
        this.showInstallPrompt(deferredPrompt);
      }
    });

    window.addEventListener('appinstalled', () => {
      this.showToast('Uygulama başarıyla yüklendi! 📱', 'success');
      deferredPrompt = null;
    });
  }

  showInstallPrompt(deferredPrompt) {
    const installBanner = document.createElement('div');
    installBanner.innerHTML = `
      <div style="position:fixed;bottom:80px;left:16px;right:16px;background:var(--card);border:1px solid var(--border);border-radius:16px;padding:16px;z-index:999;box-shadow:var(--shadow-lg)">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div>
            <div style="font-weight:600;margin-bottom:4px">📱 Uygulamayı Yükle</div>
            <div style="font-size:14px;color:var(--muted)">Ana ekranına hızlı erişim için ekle</div>
          </div>
          <div style="display:flex;gap:8px">
            <button class="btn btn-primary" onclick="this.parentElement.parentElement.parentElement.parentElement.querySelector('.install-btn').click()" style="padding:8px 16px;font-size:14px">Yükle</button>
            <button class="btn btn-secondary" onclick="this.parentElement.parentElement.parentElement.parentElement.remove()" style="padding:8px 16px;font-size:14px">✕</button>
          </div>
        </div>
      </div>
    `;

    const installBtn = installBanner.querySelector('.install-btn') || document.createElement('button');
    installBtn.onclick = () => {
      deferredPrompt.prompt();
      deferredPrompt.userChoice.then((choiceResult) => {
        if (choiceResult.outcome === 'accepted') {
          this.showToast('Uygulama yükleniyor! 📱', 'success');
        }
      });
      installBanner.remove();
    };

    document.body.appendChild(installBanner);

    setTimeout(() => {
      if (installBanner.parentElement) {
        installBanner.remove();
      }
    }, 10000);
  }

  // Data Management
  loadNotes() {
    try {
      return JSON.parse(localStorage.getItem(this.STORAGE_KEY) || '[]');
    } catch (error) {
      console.error('Error loading notes:', error);
      return [];
    }
  }

  saveNotes() {
    try {
      localStorage.setItem(this.STORAGE_KEY, JSON.stringify(this.notes));
    } catch (error) {
      console.error('Error saving notes:', error);
      this.showToast('Kaydetme hatası!', 'danger');
    }
  }

  generateId() {
    return Date.now().toString(36) + Math.random().toString(36).slice(2);
  }

  // Note Operations
  addNote() {
    const title = document.getElementById('titleInput').value.trim();
    const content = document.getElementById('contentInput').value.trim();
    const tags = document.getElementById('tagsInput').value.trim();
    const category = document.getElementById('categorySelect').value;

    if (!title && !content) {
      this.showToast('Boş not eklenemez!', 'warning');
      return;
    }

    const note = {
      id: this.generateId(),
      title: title || 'Başlıksız Not',
      content,
      tags,
      category,
      color: this.selectedColor,
      pinned: false,
      archived: false,
      created: Date.now(),
      updated: Date.now()
    };

    this.notes.unshift(note);
    this.saveNotes();
    this.clearForm();
    this.render();
    this.showToast('Not başarıyla eklendi! 📝', 'success');
    this.hapticFeedback();
  }

  editNote(id) {
    const note = this.notes.find(n => n.id === id);
    if (!note) return;

    this.editingId = id;
    document.getElementById('editTitle').value = note.title || '';
    document.getElementById('editContent').value = note.content || '';
    document.getElementById('editTags').value = note.tags || '';
    document.getElementById('editCategory').value = note.category || '';

    this.showModal('editModal');
  }

  saveEdit() {
    if (!this.editingId) return;

    const note = this.notes.find(n => n.id === this.editingId);
    if (!note) return;

    note.title = document.getElementById('editTitle').value.trim() || 'Başlıksız Not';
    note.content = document.getElementById('editContent').value.trim();
    note.tags = document.getElementById('editTags').value.trim();
    note.category = document.getElementById('editCategory').value;
    note.updated = Date.now();

    this.saveNotes();
    this.closeModal('editModal');
    this.render();
    this.showToast('Not güncellendi! ✅', 'success');
    this.editingId = null;
  }

  removeNote(id) {
    if (!confirm('Bu notu silmek istediğinizden emin misiniz?')) return;

    this.notes = this.notes.filter(n => n.id !== id);
    this.saveNotes();
    this.render();
    this.showToast('Not silindi! 🗑️', 'success');
    this.hapticFeedback();
  }

  togglePin(id) {
    const note = this.notes.find(n => n.id === id);
    if (note) {
      note.pinned = !note.pinned;
      note.updated = Date.now();
      this.saveNotes();
      this.render();
      this.showToast(note.pinned ? 'Not sabitlendi! 📌' : 'Sabitleme kaldırıldı!', 'success');
    }
  }

  toggleArchive(id) {
    const note = this.notes.find(n => n.id === id);
    if (note) {
      note.archived = !note.archived;
      note.updated = Date.now();
      this.saveNotes();
      this.render();
      this.showToast(note.archived ? 'Not arşivlendi! 📁' : 'Arşivden çıkarıldı!', 'success');
    }
  }

  duplicateNote(id) {
    const note = this.notes.find(n => n.id === id);
    if (note) {
      const duplicate = {
        ...note,
        id: this.generateId(),
        title: `${note.title} (Kopya)`,
        created: Date.now(),
        updated: Date.now()
      };
      this.notes.unshift(duplicate);
      this.saveNotes();
      this.render();
      this.showToast('Not kopyalandı! 📋', 'success');
    }
  }

  // Search and Filter
  doSearch() {
    this.query = document.getElementById('searchInput').value.toLowerCase();
    this.render();
  }

  searchByTag(tag) {
    document.getElementById('searchInput').value = tag;
    this.doSearch();
    this.showToast(`"${tag}" etiketi aranıyor...`, 'success');
  }

  filterNotes() {
    return this.notes.filter(note => {
      if (note.archived) return false;

      const searchText = `${note.title} ${note.content} ${note.tags} ${note.category}`.toLowerCase();
      return !this.query || searchText.includes(this.query);
    }).sort((a, b) => {
      if (a.pinned !== b.pinned) return b.pinned - a.pinned;
      return b.updated - a.updated;
    });
  }

  // Voice Commands
  handleVoiceCommand(transcript) {
    if (transcript.includes('not ekle') || transcript.includes('kaydet')) {
      this.addNote();
    } else if (transcript.includes('temizle') || transcript.includes('sil')) {
      this.clearForm();
      this.showToast('Form temizlendi! 🗑️', 'success');
    } else if (transcript.includes('ara') || transcript.includes('bul')) {
      const searchTerm = transcript.replace(/ara|bul/g, '').trim();
      if (searchTerm) {
        document.getElementById('searchInput').value = searchTerm;
        this.doSearch();
        this.showToast(`"${searchTerm}" aranıyor...`, 'success');
      }
    } else if (transcript.includes('yeni not')) {
      this.quickAdd();
    } else {
      document.getElementById('contentInput').value = transcript;
      this.showToast('Ses metne dönüştürüldü! ✍️', 'success');
    }
  }

  startVoiceNote() {
    if (!this.recognition) {
      this.showToast('Ses tanıma bu tarayıcıda desteklenmiyor!', 'danger');
      return;
    }

    if (this.isListening) {
      this.recognition.stop();
      return;
    }

    this.isListening = true;
    this.updateVoiceButton();
    this.recognition.start();
    this.showToast('Dinleniyor... 🎤', 'info');
  }

  toggleVoiceSearch() {
    if (!this.recognition) {
      this.showToast('Ses tanıma bu tarayıcıda desteklenmiyor!', 'danger');
      return;
    }

    if (this.isListening) {
      this.recognition.stop();
      return;
    }

    this.isListening = true;
    this.updateVoiceButton();

    this.recognition.onresult = (event) => {
      const transcript = event.results[0][0].transcript;
      document.getElementById('searchInput').value = transcript;
      this.doSearch();
      this.showToast(`"${transcript}" aranıyor...`, 'success');
    };

    this.recognition.start();
    this.showToast('Sesli arama başlatıldı... 🎤', 'info');
  }

  stopListening() {
    this.isListening = false;
    this.updateVoiceButton();
  }

  updateVoiceButton() {
    const voiceBtn = document.querySelector('[onclick*="toggleVoiceSearch"]');
    if (voiceBtn) {
      voiceBtn.classList.toggle('listening', this.isListening);
    }
  }

  // UI Management
  clearForm() {
    document.getElementById('titleInput').value = '';
    document.getElementById('contentInput').value = '';
    document.getElementById('tagsInput').value = '';
    document.getElementById('categorySelect').value = '';
    this.selectedColor = '#ffffff';
    this.updateColorPicker();
  }

  selectColor(color) {
    this.selectedColor = color;
    this.updateColorPicker();
  }

  updateColorPicker() {
    document.querySelectorAll('.color-dot').forEach(dot => {
      dot.classList.toggle('active', dot.dataset.color === this.selectedColor);
    });
  }

  quickAdd() {
    document.getElementById('titleInput').focus();
    this.showToast('Hızlı not ekleme! ⚡', 'success');
  }

  showModal(modalId) {
    document.getElementById(modalId).classList.add('show');
    document.body.style.overflow = 'hidden';
  }

  closeModal(modalId) {
    document.getElementById(modalId).classList.remove('show');
    document.body.style.overflow = '';
  }

  showToast(message, type = 'success') {
    const toast = document.createElement('div');
    toast.className = `toast ${type}`;
    toast.textContent = message;
    document.body.appendChild(toast);

    setTimeout(() => toast.classList.add('show'), 100);
    setTimeout(() => {
      toast.classList.remove('show');
      setTimeout(() => {
        if (toast.parentElement) {
          document.body.removeChild(toast);
        }
      }, 400);
    }, 3000);
  }

  // Photo Upload
  openPhotoUpload() {
    document.getElementById('photoUpload').click();
  }

  handlePhotoUpload(event) {
    const file = event.target.files[0];
    if (!file) return;

    if (!file.type.startsWith('image/')) {
      this.showToast('Lütfen geçerli bir resim dosyası seçin!', 'danger');
      return;
    }

    const reader = new FileReader();
    reader.onload = (e) => {
      const note = {
        id: this.generateId(),
        title: `Fotoğraf - ${file.name}`,
        content: `Fotoğraf yüklendi: ${file.name}\nBoyut: ${(file.size / 1024).toFixed(1)} KB`,
        tags: 'fotoğraf,resim',
        category: 'Medya',
        color: this.selectedColor,
        image: e.target.result,
        pinned: false,
        archived: false,
        created: Date.now(),
        updated: Date.now()
      };

      this.notes.unshift(note);
      this.saveNotes();
      this.render();
      this.showToast('Fotoğraf eklendi! 📷', 'success');
      event.target.value = '';
    };

    reader.readAsDataURL(file);
  }

  // Statistics
  showStats() {
    const total = this.notes.length;
    const pinned = this.notes.filter(n => n.pinned).length;
    const archived = this.notes.filter(n => n.archived).length;
    const categories = {};
    const tags = {};

    this.notes.forEach(note => {
      if (note.category) {
        categories[note.category] = (categories[note.category] || 0) + 1;
      }
      if (note.tags) {
        note.tags.split(',').forEach(tag => {
          const cleanTag = tag.trim();
          if (cleanTag) {
            tags[cleanTag] = (tags[cleanTag] || 0) + 1;
          }
        });
      }
    });

    const topTags = Object.entries(tags)
      .sort(([,a], [,b]) => b - a)
      .slice(0, 5);

    const statsHTML = `
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-number">${total}</div>
          <div class="stat-label">Toplam Not</div>
        </div>
        <div class="stat-card">
          <div class="stat-number">${pinned}</div>
          <div class="stat-label">Sabitlenmiş</div>
        </div>
        <div class="stat-card">
          <div class="stat-number">${archived}</div>
          <div class="stat-label">Arşivlenmiş</div>
        </div>
        <div class="stat-card">
          <div class="stat-number">${Object.keys(categories).length}</div>
          <div class="stat-label">Kategori</div>
        </div>
      </div>

      <h4 style="margin: 24px 0 16px 0; color: var(--accent);">📊 Kategoriler</h4>
      ${Object.entries(categories).length > 0 ? 
        Object.entries(categories).map(([cat, count]) => 
          `<div style="display: flex; justify-content: space-between; margin: 8px 0; padding: 8px; background: var(--bg); border-radius: 8px;">
            <span>${cat}</span>
            <span class="count-badge">${count}</span>
          </div>`
        ).join('') : 
        '<p style="color: var(--muted); text-align: center;">Henüz kategori yok</p>'
      }

      <h4 style="margin: 24px 0 16px 0; color: var(--accent);">🏷️ Popüler Etiketler</h4>
      ${topTags.length > 0 ? 
        topTags.map(([tag, count]) => 
          `<div style="display: flex; justify-content: space-between; margin: 8px 0; padding: 8px; background: var(--bg); border-radius: 8px;">
            <span>${tag}</span>
            <span class="count-badge">${count}</span>
          </div>`
        ).join('') : 
        '<p style="color: var(--muted); text-align: center;">Henüz etiket yok</p>'
      }
    `;

    document.getElementById('statsContent').innerHTML = statsHTML;
    this.showModal('statsModal');
  }

  // Theme Management
  toggleTheme() {
    const currentTheme = document.documentElement.getAttribute('data-theme');
    const newTheme = currentTheme === 'dark' ? 'light' : 'dark';

    document.documentElement.setAttribute('data-theme', newTheme);
    localStorage.setItem('theme', newTheme);

    this.showToast(newTheme === 'dark' ? 'Koyu tema! 🌙' : 'Açık tema! ☀️', 'success');
  }

  loadTheme() {
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme) {
      document.documentElement.setAttribute('data-theme', savedTheme);
    } else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
      document.documentElement.setAttribute('data-theme', 'dark');
    }
  }

  // Settings
  showSettings() {
    this.showModal('settingsModal');
  }

  // Import/Export
  exportNotes() {
    const dataStr = JSON.stringify(this.notes, null, 2);
    const dataBlob = new Blob([dataStr], { type: 'application/json' });
    const url = URL.createObjectURL(dataBlob);
    const link = document.createElement('a');
    link.href = url;
    link.download = `kendime-notlar-${new Date().toISOString().split('T')[0]}.json`;
    link.click();
    URL.revokeObjectURL(url);
    this.showToast('Notlar dışa aktarıldı! 💾', 'success');
  }

  importNotes() {
    const file = event.target.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = (e) => {
      try {
        const importedNotes = JSON.parse(e.target.result);
        if (Array.isArray(importedNotes)) {
          this.notes = [...importedNotes, ...this.notes];
          this.saveNotes();
          this.render();
          this.showToast(`${importedNotes.length} not içe aktarıldı! 📂`, 'success');
        } else {
          this.showToast('Geçersiz dosya formatı!', 'danger');
        }
      } catch (error) {
        this.showToast('Dosya okuma hatası!', 'danger');
      }
      event.target.value = '';
    };
    reader.readAsText(file);
  }

  clearAllData() {
    if (!confirm('Tüm notlarınız silinecek! Bu işlem geri alınamaz.')) return;
    if (!confirm('Son kez soruyorum: Gerçekten tüm verileri silmek istiyorum!')) return;

    this.notes = [];
    this.saveNotes();
    this.render();
    this.showToast('Tüm veriler silindi! 🗑️', 'warning');
    this.closeModal('settingsModal');
  }

  // Utility Functions
  formatDate(timestamp) {
    return new Date(timestamp).toLocaleDateString('tr-TR', {
      day: '2-digit',
      month: '2-digit',
      year: 'numeric',
      hour: '2-digit',
      minute: '2-digit'
    });
  }

  escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
  }

  debounce(func, wait) {
    let timeout;
    return function executedFunction(...args) {
      const later = () => {
        clearTimeout(timeout);
        func(...args);
      };
      clearTimeout(timeout);
      timeout = setTimeout(later, wait);
    };
  }

  hapticFeedback() {
    if (this.isMobile && 'vibrate' in navigator) {
      navigator.vibrate(50);
    }
  }

  extractNoteId(noteCard) {
    // Extract note ID from note card (implementation depends on your HTML structure)
    const editBtn = noteCard.querySelector('[onclick*="editNote"]');
    if (editBtn) {
      const match = editBtn.getAttribute('onclick').match(/'([^']+)'/);
      return match ? match[1] : null;
    }
    return null;
  }

  autoSave() {
    // Auto-save draft functionality
    const draft = {
      title: document.getElementById('titleInput').value,
      content: document.getElementById('contentInput').value,
      tags: document.getElementById('tagsInput').value,
      category: document.getElementById('categorySelect').value,
      color: this.selectedColor
    };
    localStorage.setItem('kendime_draft', JSON.stringify(draft));
  }

  loadDraft() {
    try {
      const draft = JSON.parse(localStorage.getItem('kendime_draft') || '{}');
      if (draft.title || draft.content) {
        document.getElementById('titleInput').value = draft.title || '';
        document.getElementById('contentInput').value = draft.content || '';
        document.getElementById('tagsInput').value = draft.tags || '';
        document.getElementById('categorySelect').value = draft.category || '';
        this.selectedColor = draft.color || '#ffffff';
        this.updateColorPicker();
      }
    } catch (error) {
      console.error('Error loading draft:', error);
    }
  }

  clearDraft() {
    localStorage.removeItem('kendime_draft');
  }

  showWelcomeMessage() {
    if (this.notes.length === 0) {
      setTimeout(() => {
        this.showToast('Kendime\'ye hoş geldiniz! 🎉 İlk notunuzu ekleyin.', 'success');
      }, 1000);
    }
  }

  // Main render function
  render() {
    const filteredNotes = this.filterNotes();
    const container = document.getElementById('notesContainer');
    const countElement = document.getElementById('noteCount');

    countElement.textContent = `${filteredNotes.length} not`;

    if (filteredNotes.length === 0) {
      container.innerHTML = `
        <div style="grid-column: 1 / -1; text-align: center; padding: 60px 20px; color: var(--muted);">
          <div style="font-size: 48px; margin-bottom: 16px;">📝</div>
          <h3 style="margin-bottom: 8px;">Henüz not yok</h3>
          <p>İlk notunuzu eklemek için yukarıdaki formu kullanın veya + butonuna tıklayın.</p>
        </div>
      `;
      return;
    }

    container.innerHTML = filteredNotes.map(note => `
      <div class="note-card ${note.pinned ? 'pinned' : ''}" style="background: ${note.color}">
        <div class="note-header">
          <div>
            ${note.category ? `<span class="category-badge">${note.category}</span>` : ''}
            ${note.pinned ? '<span style="color: var(--accent); font-size: 16px;">📌</span>' : ''}
          </div>
          <div class="note-actions">
            <button class="note-action" onclick="app.togglePin('${note.id}')" title="${note.pinned ? 'Sabitlemeyi kaldır' : 'Sabitle'}">
              ${note.pinned ? '📌' : '📍'}
            </button>
            <button class="note-action" onclick="app.editNote('${note.id}')" title="Düzenle">✏️</button>
            <button class="note-action" onclick="app.duplicateNote('${note.id}')" title="Kopyala">📋</button>
            <button class="note-action" onclick="app.toggleArchive('${note.id}')" title="Arşivle">📁</button>
            <button class="note-action" onclick="app.removeNote('${note.id}')" title="Sil">🗑️</button>
          </div>
        </div>

        <h4 class="note-title">${this.escapeHtml(note.title)}</h4>

        ${note.image ? `
          <img src="${note.image}" style="max-width: 100%; height: auto; border-radius: 8px; margin: 12px 0;" alt="Yüklenen resim">
        ` : ''}

        <div class="note-content">${this.escapeHtml(note.content.slice(0, 200))}${note.content.length > 200 ? '...' : ''}</div>

        ${note.tags ? `
          <div style="margin: 12px 0;">
            ${note.tags.split(',').filter(t => t.trim()).slice(0, 3).map(tag => 
              `<span class="tag" onclick="app.searchByTag('${tag.trim()}')">${tag.trim()}</span>`
            ).join('')}
          </div>
        ` : ''}

        <div class="note-meta">
          <span>📅 ${this.formatDate(note.created)}</span>
          ${note.updated !== note.created ? `<span>✏️ ${this.formatDate(note.updated)}</span>` : ''}
        </div>
      </div>
    `).join('');
  }
}

// Global functions for onclick handlers
let app;

function addNote() { app.addNote(); }
function editNote(id) { app.editNote(id); }
function saveEdit() { app.saveEdit(); }
function removeNote(id) { app.removeNote(id); }
function togglePin(id) { app.togglePin(id); }
function toggleArchive(id) { app.toggleArchive(id); }
function duplicateNote(id) { app.duplicateNote(id); }
function clearForm() { app.clearForm(); }
function selectColor(color) { app.selectColor(color); }
function doSearch() { app.doSearch(); }
function quickAdd() { app.quickAdd(); }
function toggleVoiceSearch() { app.toggleVoiceSearch(); }
function startVoiceNote() { app.startVoiceNote(); }
function openPhotoUpload() { app.openPhotoUpload(); }
function handlePhotoUpload(event) { app.handlePhotoUpload(event); }
function showStats() { app.showStats(); }
function showSettings() { app.showSettings(); }
function toggleTheme() { app.toggleTheme(); }
function exportNotes() { app.exportNotes(); }
function importNotes() { app.importNotes(); }
function clearAllData() { app.clearAllData(); }
function showModal(modalId) { app.showModal(modalId); }
function closeModal(modalId) { app.closeModal(modalId); }

// Initialize app when DOM is loaded
document.addEventListener('DOMContentLoaded', () => {
  app = new KendimeApp();
  app.loadTheme();
  app.loadDraft();
});

// Clear draft when note is added
document.addEventListener('noteAdded', () => {
  app.clearDraft();
});
</script>
</body>
</html><!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Kendime Test</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <button onclick="toggleTheme()">🌙 Tema Değiştir</button>

  <h1>Kendime Notlar</h1>

  <div id="noteForm">
    <input type="text" id="noteInput" placeholder="Notunu yaz..." />
    <select id="noteCategory">
      <option value="kişisel">Kişisel</option>
      <option value="iş">İş</option>
      <option value="hedef">Hedef</option>
    </select>
    <button onclick="addNote()">+ Ekle</button>
  </div>

  <p id="emptyMessage">Henüz notun yok. Hadi ilk adımı at! 🚀</p>
  <ul id="noteList"></ul>

  <script src="script.js"></script>
</body>
</html>
